<div class="d-flex flex-column w-75 align-items-center mx-auto my-4">
    <div class="d-flex flex-column w-100 mb-4">
        <h1>
            Detalles del pedido
        </h1>
        <p>
            A continuación se muestran los productos que has añadido a tu carrito
        </p>
    </div>
    <div class="row w-100 gx-4 ">
        <div class="col-md-6 overflow-y-scroll mb-3 border p-2 bg-light mr-2" style="max-height: 400px; ">
            @for (item of cartService.getItems(); track $index) {
            <div class="d-flex justify-content-between align-items-center border rounded-2 p-2 mb-3 shadow-sm">
                <div class="d-flex flex-column">
                    <strong>{{ item.name }}</strong>
                    <div class="d-flex my-1">Precio unitario: $ {{ item.unitaryPrice }}</div>
                    <div class="d-flex">Precio total: $ {{ item.totalPrice }}</div>
                    <div class="d-flex flex-row align-items-center">
                        <div>Cantidad: </div>
                        <div>
                            <div class="input-group" style="max-width: 120px;">
                                <button class="btn btn-outline-secondary rounded-circle border-0"
                                    (click)="decrementQuantity(item)"><i class="bi bi-dash-circle"></i></button>
                                <input type="text" class="form-control text-center border-0" [(ngModel)]="item.quantity"
                                    readonly>
                                <button class="btn btn-outline-secondary rounded-circle border-0"
                                    (click)="incrementQuantity(item)"><i class="bi bi-plus-circle"></i></button>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="d-flex">
                    <div class="me-3">
                        <img [src]="'assets/images/' + item.image" alt="{{ item.name }}" width="50"
                            height="50" class="mt-2">
                    </div>
                    <button class="btn btn-outline-danger"><i class="bi bi-trash"
                            (click)="removeItem($index) "></i></button>
                </div>
            </div>
            }
        </div>
        <div class="p-4 border rounded-2 shadow-sm col-md-6 h-100 bg-light">
            <h4>Información del Cliente</h4>
            <small class="text-danger">Los campos con <strong>*</strong> son obligatorios</small>
            <form [formGroup]="clientQuotationForm" class="d-flex flex-column mt-4">
                <div class="mb-3">
                    <label for="clientName" class="form-label">Nombre del Cliente <strong
                            class="text-danger">*</strong></label>
                    <input type="text" class="form-control" formControlName="clientName" id="clientName"
                        placeholder="Nombre completo" [ngClass]="{'is-invalid': clientQuotationForm.get('clientName')?.invalid && (clientQuotationForm.get('clientName')?.touched || clientQuotationForm.get('clientName')?.dirty)}">
                    @if ( clientQuotationForm.get('clientName')?.invalid && (clientQuotationForm.get('clientName')?.touched || clientQuotationForm.get('clientName')?.dirty)) {
                        <small class="text-danger">El nombre es obligatorio</small>
                    }
                </div>
                <div class="mb-3">
                    <label for="clientCompany" class="form-label">Nombre de la empresa </label>
                    <input type="text" class="form-control" formControlName="clientCompany" id="clientCompany"
                        placeholder="Nombre completo">
                </div>
                <div class="mb-3">
                    <label for="clientAddress" class="form-label">Direccion del Cliente</label>
                    <input type="text" class="form-control" formControlName="clientAddress" id="clientAddress"
                        placeholder="Direccion">
                </div>
                <div class="mb-3">
                    <label for="clientEmail" class="form-label">Correo Electronico <strong
                            class="text-danger">*</strong></label>
                    <input type="email" class="form-control" formControlName="clientEmail" id="clientEmail"
                        placeholder="Correo electronico" [ngClass]="{'is-invalid': clientQuotationForm.get('clientEmail')?.invalid && (clientQuotationForm.get('clientEmail')?.touched || clientQuotationForm.get('clientEmail')?.dirty)}">
                    @if ( clientQuotationForm.get('clientEmail')?.invalid && (clientQuotationForm.get('clientEmail')?.touched || clientQuotationForm.get('clientEmail')?.dirty)) {
                        <small class="text-danger">El correo electronico es obligatorio y debe tener un formato valido</small>
                    }
                </div>
                <div class="mb-3">
                    <label for="clientPhone" class="form-label">Telefono de Contacto <strong
                            class="text-danger">*</strong></label>
                    <input type="tel" class="form-control" formControlName="clientPhone" id="clientPhone"
                        placeholder="Numero de telefono" [ngClass]="{'is-invalid': clientQuotationForm.get('clientPhone')?.invalid && (clientQuotationForm.get('clientPhone')?.touched || clientQuotationForm.get('clientPhone')?.dirty)}">
                    @if ( clientQuotationForm.get('clientPhone')?.invalid && (clientQuotationForm.get('clientPhone')?.touched || clientQuotationForm.get('clientPhone')?.dirty)) {
                        <small class="text-danger">El telefono es obligatorio</small> 
                    }          
                </div>
            </form>
        </div>
    </div>
    <div class="bottom-0 mt-3 w-100 border-top p-3 z-3 bg-white shadow">
        <div>
            <p>Total de productos: <strong>{{ cartService.getItems().length }}</strong></p>
            <p>Total de artículos: <strong>{{ this.getTotalQuantity() }}</strong></p>
        </div>
        <div class="d-flex justify-content-center">
            <button class="btn btn-warning text-white w-50 mt-3" (click)="sendQuotation()"><i
                    class="bi bi-send mx-2"></i>Enviar pedido</button>
        </div>
    </div>
</div>